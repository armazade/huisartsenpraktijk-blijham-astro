---
---

<div class="relative" id="search-container">
  <form action="/zoeken" method="get" class="relative">
    <label for="search-input" class="sr-only">Zoeken op de website</label>
    <input
      type="search"
      id="search-input"
      name="q"
      placeholder="Zoeken..."
      class="w-full sm:w-64 pl-10 pr-4 py-2 border-2 border-gray-300 rounded-lg focus:border-primary-500 focus:outline-none"
      autocomplete="off"
    />
  </form>

  <!-- Search results dropdown -->
  <div
    id="search-results"
    class="absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 hidden"
    role="listbox"
    aria-label="Zoekresultaten"
  >
    <ul class="py-2 max-h-96 overflow-y-auto" id="search-results-list">
      <!-- Results will be inserted here by JavaScript -->
    </ul>
    <div id="search-no-results" class="hidden px-4 py-3 text-gray-500 text-center">
      Geen resultaten gevonden
    </div>
  </div>
</div>

<script>
  interface SearchPage {
    title: string;
    href: string;
    content: string;
  }

  // Search data - pages and their content
  const searchablePages: SearchPage[] = [
    { title: 'Home', href: '/', content: 'welkom huisartsenpraktijk blijham' },
    { title: 'Medewerkers', href: '/team', content: 'team medewerkers huisarts doktersassistente poh' },
    { title: 'Doktersassistente', href: '/doktersassistente', content: 'doktersassistente assistente telefonisch afspraak' },
    { title: 'POH Somatiek', href: '/praktijkondersteuner-somatiek', content: 'praktijkondersteuner somatiek diabetes copd astma hart chronisch' },
    { title: 'POH GGZ', href: '/praktijkondersteuner-ggz', content: 'praktijkondersteuner ggz geestelijke gezondheid psychisch angst depressie' },
    { title: 'Apotheek', href: '/apotheek', content: 'apotheek medicijnen medicatie recept' },
    { title: 'Afwezigheid en vakanties', href: '/afwezigheid-en-vakanties', content: 'afwezigheid vakantie waarneming gesloten' },
    { title: 'Routebeschrijving', href: '/routebeschrijving', content: 'route adres bereikbaarheid kaart parkeren' },
    { title: 'Klachtenregeling', href: '/klachtenregeling', content: 'klacht klachten regeling ontevreden' },
    { title: 'Afspraak maken', href: '/afspraak-maken', content: 'afspraak consult spreekuur bellen' },
    { title: 'Nieuws', href: '/nieuws', content: 'nieuws berichten actualiteit' },
    { title: 'Thuisarts nieuws', href: '/thuisarts-nieuws', content: 'thuisarts gezondheid informatie' },
    { title: 'Geneesmiddelen mee op reis', href: '/geneesmiddelen-mee-op-reis', content: 'reis reizen vakantie medicijnen buitenland' },
    { title: 'Herhaalrecepten', href: '/herhaalrecepten', content: 'herhaalrecept recept medicijnen aanvragen bestellen' },
    { title: 'Privacy', href: '/privacy', content: 'privacy gegevens bescherming avg' },
    { title: 'Voorwaarden', href: '/voorwaarden', content: 'voorwaarden algemeen' },
  ];

  const searchInput = document.getElementById('search-input') as HTMLInputElement;
  const searchResults = document.getElementById('search-results');
  const searchResultsList = document.getElementById('search-results-list');
  const searchNoResults = document.getElementById('search-no-results');

  function performSearch(query: string): SearchPage[] {
    const searchTerm = query.toLowerCase().trim();
    if (searchTerm.length < 2) return [];

    return searchablePages.filter(page =>
      page.title.toLowerCase().includes(searchTerm) ||
      page.content.toLowerCase().includes(searchTerm)
    );
  }

  function renderResults(results: SearchPage[]): void {
    if (!searchResultsList || !searchNoResults || !searchResults) return;

    if (results.length === 0) {
      searchResultsList.innerHTML = '';
      searchNoResults.classList.remove('hidden');
      searchResults.classList.remove('hidden');
      return;
    }

    searchNoResults.classList.add('hidden');
    searchResultsList.innerHTML = results.map(page => `
      <li role="option">
        <a href="${page.href}" class="block px-4 py-3 hover:bg-primary-50 hover:text-primary-700">
          ${page.title}
        </a>
      </li>
    `).join('');
    searchResults.classList.remove('hidden');
  }

  searchInput?.addEventListener('input', (e) => {
    const target = e.target as HTMLInputElement;
    const query = target.value;

    if (query.length < 2) {
      searchResults?.classList.add('hidden');
      return;
    }

    const results = performSearch(query);
    renderResults(results);
  });

  // Close search results when clicking outside
  document.addEventListener('click', (e) => {
    const target = e.target as HTMLElement;
    const container = document.getElementById('search-container');
    if (container && !container.contains(target)) {
      searchResults?.classList.add('hidden');
    }
  });

  // Handle keyboard navigation
  searchInput?.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      searchResults?.classList.add('hidden');
      searchInput.blur();
    }
  });
</script>
